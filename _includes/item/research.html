<div class="flex-item fi-compact">
  <div class="fi-main">
    {% comment %}Check if work title ends with ? or ! {% endcomment %}
    {% capture work_title_slice %}{{ include.pass.work_title | slice: -1, 1 }}{% endcapture %}
    {% if "?!" contains work_title_slice %}
      {% assign work_title_special_punct_tf = true %}
    {% else %}
      {% assign work_title_special_punct_tf = false %}
    {% endif %}

    {% capture citation_start %}{% if include.pass.pdf_filename == null %}{{ include.pass.work_authors }} ({{ include.pass.work_year }}){% else %}<a href="{{ "/assets/pdf/publications/" | prepend: site.baseurl | append: include.pass.pdf_filename }}" target="_blank">{{ include.pass.work_authors }} ({{ include.pass.work_year }})</a>{% endif %}. <cite class="no-italic">{{ include.pass.work_title }}</cite>{% endcapture %}

    {% case include.pass.work_publication_format %}
      {% when "article_in_journal" %}<p class="citation">{{ citation_start }}{% if include.pass.journal_data.review_tf %} [Review of the {{ include.pass.journal_data.review_data.reviewed_work_type }} <cite>{{ include.pass.journal_data.review_data.reviewed_work_title}}</cite>, by {{ include.pass.journal_data.review_data.reviewed_work_author }}]<!-- endif for review_tf -->{% endif %}{% unless work_title_special_punct_tf %}.<!-- endunless for work_title_special_punct_tf -->{% endunless %} <i>{{ include.pass.journal_data.journal_title }}{% if include.pass.journal_data.advance_tf %}</i>. Advance online publication{% else %}, {{ include.pass.journal_data.journal_vol }}</i>{% if include.pass.journal_data.journal_issue != null %}({{ include.pass.journal_data.journal_issue }})<!-- endif for journal_issue != null -->{% endif %}, {{ include.pass.journal_data.journal_pages_start }}-{{ include.pass.journal_data.journal_pages_stop }}<!-- endif for journal_advance_tf -->{% endif %}. {% if include.pass.journal_data.doi != null %}doi: {{ include.pass.journal_data.doi }}<!-- endif journal_doi != null -->{% endif %}</p>
      {% when "article_in_edited_work" %}<p class="citation">{{ citation_start }}{% unless work_title_special_punct_tf %}.{% endunless %} In {{ include.pass.edited_work_data.edited_work_editors }}, <cite>{{ include.pass.edited_work_data.edited_work_title }}</cite> (pp. {{ include.pass.edited_work_data.edited_work_pages_start }}-{{ include.pass.edited_work_data.edited_work_pages_stop }}). {{ include.pass.edited_work_data.edited_work_location }}: {{ include.pass.edited_work_data.edited_work_publisher }}.</p>
    {% endcase %}
  </div>
</div>
